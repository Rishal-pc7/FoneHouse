generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Cart {
  id        Int        @id @default(autoincrement())
  userId    Int?       @unique
  sessionId String?    @unique
  updatedAt DateTime   @default(now())
  createdAt DateTime   @default(now())
  totalPrice Int
  totalItems Int
  
  Users     Users?     @relation(fields: [userId], references: [id])
  CartItem  CartItem[]
}

model CartItem {
  id        Int      @id @default(autoincrement())
  cartId    Int
  productId Int
  quantity  Int      @default(1)
  Cart      Cart     @relation(fields: [cartId], references: [id])
  Products  Products @relation(fields: [productId], references: [id])
  @@unique([cartId, productId])
}

model Orders {
  id           Int      @id @default(autoincrement())
  userId       Int?
  sessionId    String?
  totalPrice   Int
  status       String   @default("PENDING")
  email        String
  firstName    String
  lastName     String
  address      String
  city         String
  postalCode   String
  phone        String
  paymentMethod String
  created_at   DateTime @default(now())
  OrderItem    OrderItem[]
  Users        Users?   @relation(fields: [userId], references: [id])
}
model OrderItem{
  id        Int      @id @default(autoincrement())
  orderId   Int
  productId Int
  quantity  Int      @default(1)
  Orders     Orders     @relation(fields: [orderId], references: [id])
  Products  Products @relation(fields: [productId], references: [id])
  @@unique([orderId, productId])
}

model Products {
  id             Int        @id @default(autoincrement())
  name           String
  brand          String     @default("Unknown")
  stock          Int        @default(0)
  isInStock      Boolean    @default(true)
  price          Decimal
  category       String
  img            String
  description    String?
  specifications Json?
  created_at     DateTime   @default(now())
  CartItem       CartItem[]
  OrderItem      OrderItem[]
}

model Users {
  id       Int      @id @default(autoincrement())
  name     String
  email    String   @unique
  password String
  Cart     Cart?
  Orders   Orders[]
}
